<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: texture-string.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: texture-string.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>export async function loadImage(src) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        img.src = src;
        img.onload = () => resolve(img);
        img.onerror = err => reject(err);
    });
}

/**
 * Returns UTF-16 array of each char
 * @param {String} s
 * @returns {Array&lt;Number>}
 */
function strToCodes(s) {
    return Array.from(s).map(c => c.charCodeAt(0))
}

/**
 *
 * @param {HTMLImageElement} atlas Image atlas to parse
 * @param {CanvasRenderingContext2D} ctx Canvas context
 * @param {Number} index index in the atlas, so 0 is the first char
 * @param {{x: number, y: number}} size cell dimensions
 * @param {Number} finalIndex final positional index in the canvas
 */
function sprite(atlas, ctx, index, size, finalIndex) {
    const { width } = atlas;
    const numColumns = width / size.x

    const x = index % numColumns;
    const y = Math.floor(index / numColumns);

    ctx.drawImage(
        atlas,
        x * size.x,
        y * size.y,
        size.x,
        size.y,

        size.x * finalIndex,
        0,

        size.x,
        size.y);
}

/**
 * @typedef {number} SignedNumber
 * A numeric value that may be negative or positive.
 */

/**
 * Expects an atlas/spritesheed with chars in UTF-16 order.
 * This means `A` is expected at index `65`; if not there,
 * use offset to move backwards (negative) or forward (positive)
 * @param {String} str String used to extract letters from the image
 * @param {HTMLImageElement} atlasImg image with the Atlas to extract letters from
 * @param {{x: number, y: number}} size width and height in pixels of each letter
 * @param {SignedNumber} offset how many chars is the atlas offset from the UTF-16
 * @returns {string} Base64 image
 */
export function strToImage(str, atlasImg, size, offset = 0) {
    const chars = strToCodes(str);
    const canvas = document.createElement('canvas');
    canvas.width = chars.length * size.x;
    canvas.height = size.y;
    const ctx = canvas.getContext('2d');

    chars.forEach((c, i) => sprite(atlasImg, ctx, c + offset, size, i));
    return canvas.toDataURL('image/png');
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#add">add</a></li><li><a href="global.html#addAudio">addAudio</a></li><li><a href="global.html#addBindingTexture">addBindingTexture</a></li><li><a href="global.html#addEventListener">addEventListener</a></li><li><a href="global.html#addLayers">addLayers</a></li><li><a href="global.html#addPoint">addPoint</a></li><li><a href="global.html#addRenderPass">addRenderPass</a></li><li><a href="global.html#addSampler">addSampler</a></li><li><a href="global.html#addStorage">addStorage</a></li><li><a href="global.html#addStorageMap">addStorageMap</a></li><li><a href="global.html#addTexture2d">addTexture2d</a></li><li><a href="global.html#addTextureImage">addTextureImage</a></li><li><a href="global.html#addTextureVideo">addTextureVideo</a></li><li><a href="global.html#addTextureWebcam">addTextureWebcam</a></li><li><a href="global.html#addUniform">addUniform</a></li><li><a href="global.html#bloom">bloom</a></li><li><a href="global.html#blur">blur</a></li><li><a href="global.html#chromaticAberration">chromaticAberration</a></li><li><a href="global.html#color">color</a></li><li><a href="global.html#createScreen">createScreen</a></li><li><a href="global.html#delta">delta</a></li><li><a href="global.html#filmgrain">filmgrain</a></li><li><a href="global.html#getDelta">getDelta</a></li><li><a href="global.html#grayscale">grayscale</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#isArray">isArray</a></li><li><a href="global.html#lensDistortion">lensDistortion</a></li><li><a href="global.html#pixelate">pixelate</a></li><li><a href="global.html#setAudio">setAudio</a></li><li><a href="global.html#setBindingTexture">setBindingTexture</a></li><li><a href="global.html#setLayers">setLayers</a></li><li><a href="global.html#setMeshDensity">setMeshDensity</a></li><li><a href="global.html#setSampler">setSampler</a></li><li><a href="global.html#setStorage">setStorage</a></li><li><a href="global.html#setStorageMap">setStorageMap</a></li><li><a href="global.html#setTexture2d">setTexture2d</a></li><li><a href="global.html#setTextureImage">setTextureImage</a></li><li><a href="global.html#setTextureImageArray">setTextureImageArray</a></li><li><a href="global.html#setTextureString">setTextureString</a></li><li><a href="global.html#setTextureVideo">setTextureVideo</a></li><li><a href="global.html#setTextureWebcam">setTextureWebcam</a></li><li><a href="global.html#setUniform">setUniform</a></li><li><a href="global.html#sprite">sprite</a></li><li><a href="global.html#strToCodes">strToCodes</a></li><li><a href="global.html#strToImage">strToImage</a></li><li><a href="global.html#time">time</a></li><li><a href="global.html#updateStorageMap">updateStorageMap</a></li><li><a href="global.html#updateTextureImage">updateTextureImage</a></li><li><a href="global.html#updateUniform">updateUniform</a></li><li><a href="global.html#updateUniforms">updateUniforms</a></li><li><a href="global.html#waves">waves</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Jul 31 2025 11:46:56 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
